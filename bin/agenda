#!/usr/bin/env python3
"""
Programmable agenda.

Usage:
    agenda [--days=D] [--no-color]
    agenda txt [--days=D]
    agenda ical [--ical-days=I]
    agenda server [--ical-days=I] [--host=HOST] [--port=PORT]
    agenda add DATE DESCRIPTION...
    agenda -h | --help

Options:
    -h --help      Show this screen.
    --days=D       Report for this many days. [default: 7]
    --no-color     Don't use colors.
    --ical-days=I  Generate iCal for this many days. [default: 62]
    --host=HOST    Server host. [default: localhost]
    --port=PORT    Server port. [default: 7000]
"""
from docopt import docopt

from agenda.events import load_events
from agenda import server
from agenda import report
from agenda.add import add


def main():
    arguments = docopt(__doc__)

    load_events()
    if arguments['ical']:
        report.ical(int(arguments['--ical-days']))
    elif arguments['txt']:
        report.txt(int(arguments['--days']))
    elif arguments['server']:
        server.run(
            int(arguments['--ical-days']),
            arguments['--host'],
            int(arguments['--port']))
    elif arguments['add']:
        add(arguments['DATE'], ' '.join(arguments['DESCRIPTION']))
    else:
        report.agenda(int(arguments['--days']), color=not arguments['--no-color'])


if __name__ == '__main__':
    main()
